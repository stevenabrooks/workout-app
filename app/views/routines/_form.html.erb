####################################

<%= form_tag routines_path %>

  <%= label_tag "routine[name]", "Routine Name" %>
  <%= text_field_tag "routine[name]" %><br />


  
      <fieldset id="exercises">
        <div class="exercise">
          <div class="ui-widget">
            <%= text_field_tag "[lifts][][0][exercise_id]", nil, :placeholder => "Choose Exercise", class: "ex" %>
          </div>
          <button class="remove">remove exercise</button>
        </div>
      </fieldset>

      <button id="add_exercise">add exercise</button>
  

  
<%= submit_tag "Submit Routine" %>

<script>
$(function() {

  var n = 0;

  $('#add_exercise').on('click', function() { 

    //n += 1;  

    var exercises = $(' <div class="exercise"> \
          <div class="ui-widget"> \
            <input type="text" name="[lifts][]['+(n += 1)+'][exercise_id]" placeholder="Choose Exercise" class="ex"> \
          </div> \
          <button class="remove">remove exercise</button> \
        </div>');

    console.log(exercises);

    $(exercises).find('.ex').attr('name', '[lifts][]['+n+'][exercise_id]');

    console.log(exercises);


    $('#exercises').append(exercises);
    return false; //prevent form submission
  });

  $('#exercises').on('click', '.remove', function() {
      $(this).parent().remove();
      return false; //prevent form submission
  });

  var availableExercises = [
        <% Exercise.all.each do |exercise| %>
        '<%= exercise.name %>',
        <% end %>
      ];

  $('#exercises').on('keydown.autocomplete', '.ex', function() {
    $(this).autocomplete({source: availableExercises});
  });

});
</script>